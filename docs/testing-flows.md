# Pinterest for WooCommerce - Testing & Flows

This file is a collection of the flows (key UI and features) that are implemented.

These flows can be used when testing PRs or releases, and as a basis for documentation.

## Onboarding & connection

- Merchant can connect and disconnect to a valid Pinterest Business account.
- Helpful error messages are shown if the connection fails (e.g. Pinterest account is invalid or unverified).
- Unauthorised users cannot connect, disconnect or verify domain.
- An Advertiser and a Conversion Tag will be automatically created if the Merchant doesn't already have one.

1. Connect the plugin to the Pinterest Business account.
  ![Connect account](./images/onboarding-connect-account.png)

2. Verify the store's domain.
  ![Connect account](./images/onboarding-domain-verification.png)

3. Select the Advertiser and the Conversion Tag.
  ![Select Advertiser and Conversion tag](./images/onboarding-select-advertiser.png)

## Domain Verification

- The store's webiste is verified during the onboarding process.
- Stores located on subdomains and subdirectories (for example, `example.com/shop`) are supported.
- Stores whose URL contains uppercase letters (for example, `example.com/SHop`) are supported.
- A URL can be claimed and verified only by a Merchant. A helpful error is displayed if a Merchant attempts to claim an already claimed website.

## Catalog (product) sync

- The feed is generated by asynchronous tasks controlled by the Action Scheduler framework.
- The feed generator obtains a batch of products during each generation cycle.
- The feed is registered in the Merchant account once the feed is successfully generated.
- Pinterest ingests the feed every 24 hours once it is properly registered in the Merchant account.
- Products that meet any of the following statements will be excluded from the feed:
  - Products with price = 0.
  - Products out of stock if the option `woocommerce_hide_out_of_stock_items` is enabled.
  - Products with visibility set to `Hidden` or `Search results only`.
  - Excluded product types are by default: `grouped` and `variable` (the parent of a variable product, the children variations are included in the feed). The value can be modified by the `pinterest_for_woocommerce_excluded_product_types` filter.
- The feed is rebuild every 24 hours.
- The feed generation process starts again if the feed is set as dirty during the feed generation. The feed is set as dirty whenever:
  - A product is added or edited.
  - The stock of a single or variation product is modified.
  - The option `update_option_woocommerce_hide_out_of_stock_items` is updated.
  - The option `update_option_woocommerce_tax_display_shop` is updated.
  - The option `update_option_woocommerce_tax_display_cart` is updated.

## Save to Pinterest button

- Shopper can save (pin) products to Pinterest from product page and archive pages, e.g. shop page.

## Pinterest pins

- Merchant can expose [OpenGraph metadata](https://ogp.me/) for products and posts to enable Rich Pins.
- Metadata passes validation in [Pinterest Rich Pins Validator](https://developers.pinterest.com/tools/url-debugger/).

## Conversion tracking

- Merchant will be able to track conversion events.
- Conversion will [track activities](https://help.pinterest.com/en/business/article/track-conversions-with-pinterest-tag): AddToCart, Checkout, PageVisit and ViewCategory.
- Merchant can enable/disable conversion tracking in the plugin's settings tab.
- Merchant can enable/disable `Enchanced Match Support`, which will add customer emails to conversion tracking.

## Miscellaneous

- Pinterest admin screens are visible and accessible in all supported WooCommerce Admin navigation variations (current WP sidebar and [forthcoming unified nav](https://developer.woocommerce.com/2021/01/15/call-to-action-create-access-for-your-extension-in-the-new-woocommerce-navigation/)).
